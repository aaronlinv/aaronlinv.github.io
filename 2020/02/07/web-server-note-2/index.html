<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="Java分类JavaSEJava的标准版，一般用来开发桌面应用程序，但是在开发桌面应用程序上相对VB，Delphi，VC++并没有什么优势
JavaEE也就是Java Enterprise Edition，Java的企业版开发JavaWeb应用程序，初级的一般是用JSP(Java Server Pa">


<link rel="alternate" href="/atom.xml" title="Aaron Lin" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>Web服务器笔记-Tomcat服务器 - Aaron Lin</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->


<!-- <link rel="shortcut icon" href="/favicon.png"> -->

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/css/style.css">
<!-- 谷歌 Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153099566-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-153099566-1');
</script>


<nav class="main-nav">
	
	    <a href="/">← 主页</a>
	
	
	    <a href="/about/">关于</a>
	
	    <a href="/archives/">归档</a>
	
	<a class="cta" href="/rss2.xml" data-no-instant>订阅</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>Web服务器笔记-Tomcat服务器</h1>
        
        <h2 class="headline">Feb 07 2020
        
            
            <a href="/categories/Web服务器笔记/#Web服务器笔记">Web服务器笔记</a>
        
        </h2>
    </header>
</article>
<section id="post-body"><h2 id="Java分类"><a href="#Java分类" class="headerlink" title="Java分类"></a>Java分类</h2><h4 id="JavaSE"><a href="#JavaSE" class="headerlink" title="JavaSE"></a>JavaSE</h4><p>Java的标准版，一般用来开发桌面应用程序，但是在开发桌面应用程序上相对VB，Delphi，VC++并没有什么优势</p>
<h4 id="JavaEE"><a href="#JavaEE" class="headerlink" title="JavaEE"></a>JavaEE</h4><p>也就是Java Enterprise Edition，Java的企业版<br>开发JavaWeb应用程序，初级的一般是用JSP(Java Server Pages) + Servlet + Javabean来开发的<br>大型的网站一般是使用框架来开发: struts , hibernate , spring , Mybatis</p>
<h4 id="JavaME"><a href="#JavaME" class="headerlink" title="JavaME"></a>JavaME</h4><p>JavaME,Java Micro Edition,Java的微型版<br>诺基亚手机上运行的Java程序就是指用这个版本开发的程序</p>
<h2 id="JavaEE规范"><a href="#JavaEE规范" class="headerlink" title="JavaEE规范"></a>JavaEE规范</h2><p>JavaEE的共有13个技术规范<br>Sun公司定义了这么多标准，其它公司的人都可以来去根据这些标准来做JavaEE程序</p>
<p>JDBC<br>Java数据连接，是一种用于执行SQL语句的Java API</p>
<p>JNDI<br>Java命名和目录接口</p>
<p>EJB<br>EJB是sun的JavaEE服务器端组件模型，设计目标与核心应用是部署分布式应用程序</p>
<p>RMI<br>远程方法调用，能够让在某个Java虚拟机上的对象调用本地对象一样的<br>调用另一个Java虚拟机中高的对象上的方法</p>
<p>JSP<br>Java服务器页面，是一个动态内容模板，实现了Html语法中的Java扩展</p>
<p>Servlet<br>Servlet是一种小型的Java程序，它扩展了Web服务器的功能</p>
<p>XML<br>是一种可扩展的标记语言</p>
<p>JMS<br>是一个Java平台中关于面向消息中间件（MOM）的API<br>用于在两个应用程序之间，或分布式系统中发送消息，进行异步通信</p>
<p>Java IDL<br>Java IDL支持的是一个瞬间的CORBA对象，即在对象服务器处理过程中有效</p>
<p>JTS<br>子主题 1组件事务监视器，TPM 是一个程序，它代表应用程序协调分布式事务的执行</p>
<p>JTA<br>JTA允许应用程序执行分布式事务处理——在两个或多个网络计算机资源上访问并且更新数据</p>
<p>JavaMail<br>提供给开发者处理电子邮件相关的编程接口</p>
<p>JAF<br>JAF是一个专用的数据处理框架，它用于封装数据，并为应用程序提供访问和操作数据的接口</p>
<h2 id="常见JavaWeb应用服务器"><a href="#常见JavaWeb应用服务器" class="headerlink" title="常见JavaWeb应用服务器"></a>常见JavaWeb应用服务器</h2><p>WebLogic<br>oracle公司的大型收费Web服务器 支持全部JavaEE规范</p>
<p>WebSphere<br>IBM公司的大型收费Web服务器 支持全部的JavaEE规范</p>
<p>Tomcat<br>Apache开源组织下的开源免费的中小型的Web应用服务器<br>支持JavaEE中的Servlet和JSP规范</p>
<h2 id="Tomcat安装"><a href="#Tomcat安装" class="headerlink" title="Tomcat安装"></a>Tomcat安装</h2><p>企业老项目一般使用Tomcat7<br>解压到</p>
<h5 id="目录介绍"><a href="#目录介绍" class="headerlink" title="目录介绍"></a>目录介绍</h5><p>bin<br>脚本程序<br>可执行的命令</p>
<p>conf<br>配置目录<br>内部有一个server.xml核心配置文件</p>
<p>lib<br>依赖库目录 </p>
<p>logs<br>日志目录</p>
<p>temps<br>临时文件目录</p>
<p>webapps<br>web应用发布目录<br>把开发的项目放到该目录当中运行</p>
<p>work<br>tomcat处理jsp的工作目录</p>
<h4 id="启动Tomcat"><a href="#启动Tomcat" class="headerlink" title="启动Tomcat"></a>启动Tomcat</h4><ol>
<li>进入到解压目录</li>
<li>找到bin目录</li>
<li>找到startup.bat双击启动脚本</li>
</ol>
<ul>
<li>没有配置JAVA_HOME</li>
</ul>
<p>在启动过程当中如果没有配置JAVA_HOME，就会一闪没了<br>JAVA_HOME配置的就是JDK bin的上级目录</p>
<ul>
<li>端口冲突,默认的端口是8080(两种解决方法)</li>
</ul>
<p>把占用的端口杀死<br>netstat -aov  查看端口占用情况  记下占用端口的pid<br>到任务管理器当中查看任务详细信息，把对应pid给关掉</p>
<p>到config目录当中修改核心配置文件server.xml，修改port</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">redirectPort</span>=<span class="string">"8443"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>通过浏览器访问：<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a><br>看到以下界面<br><img src="/2020/02/07/web-server-note-2/1.png" alt="Tomcat"><br>返回的就是一个页面<br>这个页面可以在webapps目录当中的ROOT文件夹当中找到</li>
<li>shutdown.bat停止脚本</li>
</ol>
<h2 id="手动创建项目"><a href="#手动创建项目" class="headerlink" title="手动创建项目"></a>手动创建项目</h2><ol>
<li>在webapps目录下，新建一个文件夹mytest</li>
<li>在mytest文件夹里放置html、jsp、js文件</li>
<li>在mytest内新建WEB-INF目录，在WEB-INF目录内新建：classes目录和lib目录、web.xml文件</li>
</ol>
<p>classes目录：Java类字节码文件<br>lib目录：Java类运行时需要的jar包<br>web.xml文件：当前整个web应用的核心配置文件，可以到ROOT当中复制一个过来<br><img src="/2020/02/07/web-server-note-2/2.png" alt="项目目录"></p>
<p>WEB-INF目录下当前的资源不能直接通过浏览器访问，是保护的， 外界不能直接访问</p>
<h2 id="使用开发工具构建web工程"><a href="#使用开发工具构建web工程" class="headerlink" title="使用开发工具构建web工程"></a>使用开发工具构建web工程</h2><h4 id="创建工程"><a href="#创建工程" class="headerlink" title="创建工程"></a>创建工程</h4><p>创建一个名为myproject的工程<br><img src="/2020/02/07/web-server-note-2/3.png" alt="创建项目"><br><img src="/2020/02/07/web-server-note-2/4.png" alt="选择Tomc目录"><br><img src="/2020/02/07/web-server-note-2/5.png" alt="选择web module版本"><br>3.0不会在WEB_INF 里生成xml文件</p>
<h4 id="切换JavaEE视图"><a href="#切换JavaEE视图" class="headerlink" title="切换JavaEE视图"></a>切换JavaEE视图</h4><p><img src="/2020/02/07/web-server-note-2/6.png" alt="切换JavaEE视图"></p>
<h4 id="配置服务器"><a href="#配置服务器" class="headerlink" title="配置服务器"></a>配置服务器</h4><p>在创建项目的时候已经添加好了服务器<br><img src="/2020/02/07/web-server-note-2/7.png" alt="服务器"></p>
<p>在Servers标签创建Server<br>右键-new-Server-选择对应Tomcat版本-下面Next-添加已有的项目-Finish<br>也可通过右键已创建的Server-Add and Remove-添加已有项目</p>
<p>双击Server，修改配置<br><img src="/2020/02/07/web-server-note-2/9.png" alt="修改Server配置"><br>设置目录，发布时候就会把WebContent和字节码部署到设置好的目录里（我设置的是D:\Tomcat\apache-tomcat-7.0.85\webapps）</p>
<h4 id="发布项目"><a href="#发布项目" class="headerlink" title="发布项目"></a>发布项目</h4><p>新建index.html文件<br><img src="/2020/02/07/web-server-note-2/8.png" alt="html网页"></p>
<p>右键项目-run Server 或者 是在Server右键-Start</p>
<ol>
<li>将未发布的工程，发布到webapps下面</li>
<li>启动tomcat（如果用startup.bat打开了Tomcat，要先关闭）</li>
</ol>
<p>在发布时<br>会在Tomcat的webapps目录下创建一个名称myproject的目录<br>并且把WebContent当中的所有内容放入到webapps目录下当中的myproject目录中<br>不会把写的Java代码给放到webapps当中，运行时，只需要字节码就行了</p>
<p>浏览器访问：<a href="http://localhost:8080/myproject/" target="_blank" rel="noopener">http://localhost:8080/myproject/</a><br>就可看到刚才写的index.html</p>
<h2 id="优化Tomcat启动速度"><a href="#优化Tomcat启动速度" class="headerlink" title="优化Tomcat启动速度"></a>优化Tomcat启动速度</h2><ol>
<li>删除webApps里面的自带的项目（保留ROOT，ROOT是默认访问的项目），加快启动速度</li>
<li>复制ROOT里面的xml的web-app标签，替换当前项目的web-app标签（原因是3.0才支持优化）<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee</span></span></span><br><span class="line"><span class="tag"><span class="string">                        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">version</span>=<span class="string">"3.0"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">metadata-complete</span>=<span class="string">"true"</span>&gt;</span></span><br></pre></td></tr></table></figure>
添加上这个标签<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">absolute-ordering</span>&gt;</span><span class="tag">&lt;/<span class="name">absolute-ordering</span>&gt;</span> </span><br><span class="line">省略写法：<span class="tag">&lt;<span class="name">absolute-ordering</span>/&gt;</span></span><br></pre></td></tr></table></figure>
扫描的jar包，里面为空，就是不扫描 提升速度<br>在ROOT的xml也添加这句</li>
</ol>
<p>新建工程就可以选3.0，把修改好的web.xml复制到WEB-INF里，修改下display-name标签内容</p>
<h2 id="Tomcat服务器Context"><a href="#Tomcat服务器Context" class="headerlink" title="Tomcat服务器Context"></a>Tomcat服务器Context</h2><p>添加工程就是在conf/server.xml 中添加Context标签，一个项目就是一个Context<br><img src="/2020/02/07/web-server-note-2/10.png" alt="Context"></p>
<p>docBase<br>web应用的文件路径，相对路径，相对的是Server设置的目录</p>
<p>path<br>URL入口（网页输入的地址）</p>
<p>reloadable<br>字节码变化服务器是否重新加载web应用</p>
<h4 id="tomcat服务器体系结构"><a href="#tomcat服务器体系结构" class="headerlink" title="tomcat服务器体系结构"></a>tomcat服务器体系结构</h4><ol>
<li>Server：整个Servlet容器组合，可以包含一个或多个Service标签</li>
<li>service：它由一个或者多个Connector组成，以及一个Engine，负责处理所有Connector所获得的客户请求</li>
<li>Connector：客户端与程序交互组件，负责接收请求以及向客户端返回响应</li>
<li>Engine：处理连接器接收到请求</li>
<li>Host：虚拟主机</li>
<li>Context：一个Context对应于一个Web Application</li>
</ol>
<p><img src="/2020/02/07/web-server-note-2/11.png" alt="服务器体系"></p>
<h4 id="虚拟主机"><a href="#虚拟主机" class="headerlink" title="虚拟主机"></a>虚拟主机</h4><ol>
<li>输入网址时， 就会先到host文件当中查找有没有对应的IP地址，如何有就直接访问该IP地址</li>
<li>如果没有，就会到外网去找DNS服务器进行域名与IP地址的解析，查找</li>
<li><strong>多个域名可以访问同一个IP</strong></li>
<li>一个IP对应一台电脑</li>
</ol>
<p><img src="/2020/02/07/web-server-note-2/12.png" alt="虚拟主机"></p>
<p>修改本机host文件(C:\Windows\System32\drivers\etc)<br>Win10不能直接修改，复制到桌面修改，然后覆盖host</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1          m.myxq.com</span><br></pre></td></tr></table></figure>
<p>原来的server.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span> <span class="attr">name</span>=<span class="string">"localhost"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">unpackWARs</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"org.apache.catalina.valves.AccessLogValve"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">directory</span>=<span class="string">"logs"</span> <span class="attr">pattern</span>=<span class="string">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">prefix</span>=<span class="string">"localhost_access_log."</span> <span class="attr">suffix</span>=<span class="string">".txt"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">"myproject2"</span> <span class="attr">path</span>=<span class="string">"/myp2"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">reloadable</span>=<span class="string">"true"</span> <span class="attr">source</span>=<span class="string">"org.eclipse.jst.jee.server:myproject2"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">"myproject"</span> <span class="attr">path</span>=<span class="string">"/myproject"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">reloadable</span>=<span class="string">"true"</span> <span class="attr">source</span>=<span class="string">"org.eclipse.jst.jee.server:myproject"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>添加虚拟主机：在Host标签后面再添加一个Host标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">appBase</span>=<span class="string">"webapps"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span> <span class="attr">name</span>=<span class="string">"m.myxq.com"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">unpackWARs</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">"myproject"</span> <span class="attr">path</span>=<span class="string">"/myp2"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">reloadable</span>=<span class="string">"true"</span> <span class="attr">source</span>=<span class="string">"org.eclipse.jst.jee.server:myproject"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以在server.xml修改端口，浏览器默认访问80端口，这样就可以免输入端口<br>通过 <a href="http://m.myxq.com/myp/" target="_blank" rel="noopener">http://m.myxq.com/myp/</a> 和 <a href="http://localhost/myp/" target="_blank" rel="noopener">http://localhost/myp/</a> 访问的项目不同，不同域名映射到同一个IP</p>
<h2 id="Tomcat插件安装"><a href="#Tomcat插件安装" class="headerlink" title="Tomcat插件安装"></a>Tomcat插件安装</h2><ol>
<li><a href="https://jaist.dl.sourceforge.net/project/tomcatplugin/net.sf.eclipse.tomcat.updatesite-2018-03-08.zip" target="_blank" rel="noopener">下载插件</a></li>
<li>到Eclipse当中找到help-&gt;install new software</li>
<li>进入对话框，点击add然后弹出add Repository  选择下载的插件位置，name随便写,点击确定</li>
<li>在列表框中选中tomcat-plugin直接点击下一步</li>
<li>接受许可，然后等待，在eclipse右下角会有安装进度。进度完成时，会弹出要求重新启动eclipse</li>
</ol>
<p>配置插件与Tomcat关联<br>1.windon-&gt;preferences<br>2.找到tomcat<br>3.选择对应版本的服务器<br>4.找到tomcat服务器存放的根路径</p>
<p>Atl+t 重启服务器        </p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://study.163.com/course/introduction/1005981003.htm" target="_blank" rel="noopener">Java零基础到高级JavaWeb与项目</a></p>
</section>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/avatar.jpg">
        <div>
            <span class="dark">Aaron Lin</span>
            <span></span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" href="https://twitter.com/intent/tweet?text=https://aaronlinv.github.io/2020/02/07/web-server-note-2/ - Web服务器笔记-Tomcat服务器 @" target="_blank" rel="noopener"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">加载评论</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "Web服务器笔记-Tomcat服务器",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
    <div id="social">
        <p class="small">©
            Aaron Lin | Powered by Hexo &
                <a href="https://github.com/F0r3at/Lights" target="_blank" rel="noopener"> Lights</a>
        </p>
    </div>
</footer>
</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



