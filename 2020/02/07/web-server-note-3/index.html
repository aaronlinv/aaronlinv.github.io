<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="ServletServlet 运行在服务端的Java小程序，是sun公司提供一套规范（接口）

servlet接收响应请求
filter过滤器
listener监听器

用来处理客户端请求、响应给浏览器的动态资源servlet的实质就是java代码，通过Java的API动态的向客户端输出内容以后写的">


<link rel="alternate" href="/atom.xml" title="Aaron Lin" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>Web服务器笔记-Servlet - Aaron Lin</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->


<!-- <link rel="shortcut icon" href="/favicon.png"> -->

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/css/style.css">
<!-- 谷歌 Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153099566-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-153099566-1');
</script>


<nav class="main-nav">
	
	    <a href="/">← 主页</a>
	
	
	    <a href="/about/">关于</a>
	
	    <a href="/archives/">归档</a>
	
	<a class="cta" href="/rss2.xml" data-no-instant>订阅</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>Web服务器笔记-Servlet</h1>
        
        <h2 class="headline">Feb 07 2020
        
            
            <a href="/categories/Web服务器笔记/#Web服务器笔记">Web服务器笔记</a>
        
        </h2>
    </header>
</article>
<section id="post-body"><h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><p>Servlet 运行在服务端的Java小程序，是sun公司提供一套规范（接口）</p>
<ol>
<li>servlet接收响应请求</li>
<li>filter过滤器</li>
<li>listener监听器</li>
</ol>
<p>用来处理客户端请求、响应给浏览器的动态资源<br>servlet的实质就是java代码，通过Java的API动态的向客户端输出内容<br>以后写的程序就不在是在本地执行了。而是编译成字节码，放到服务器上来去执行。<br>编写程序时， 不需要有main函数了。因为写完后，就把编写的程序编译成字节码，放到服务器上面。当前发送就一个请求的时候，服务器就会按照一定规则调用编写的代码</p>
<h2 id="Servlet快速入门"><a href="#Servlet快速入门" class="headerlink" title="Servlet快速入门"></a>Servlet快速入门</h2><ol>
<li>创建一个web工程</li>
<li>在JavaResource中src下创建一个包名称为com.myxq.servlet</li>
<li>在创建的servlet包当中创建一个class文件起名为FirstServlet</li>
<li>进入该class实现一个Servlet接口，实现它未实现的方法，在service方法中写入一句话输出</li>
<li>在web.xml当中进行配置<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Servlet<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 在display-name 标签后添加servlet 和 servlet-mapping配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myxq<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.it666.servlet.FirstServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myxq<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/firstServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.it666.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"Hello Servlet"</span>);</span><br><span class="line">		HttpServletResponse r = (HttpServletResponse) res;</span><br><span class="line">		r.getWriter().write(<span class="string">"getWriter"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果<br><img src="/2020/02/07/web-server-note-3/1.png" alt="执行结果"></p>
<p>修改url路径<br><img src="/2020/02/07/web-server-note-3/2.png" alt="修改url路径"></p>
<h2 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h2><h4 id="类的加载时机"><a href="#类的加载时机" class="headerlink" title="类的加载时机"></a>类的加载时机</h4><p>当程序要使用某个类时，如果该类还未被加载到内存中，系统会通过加载，连接，初始化三步来实现对这个类进行初始化</p>
<ul>
<li>加载<br>就是指将class文件读入内存，并为之创建一个Class对象。任何类被使用时系统都会建立一个Class对象</li>
<li>连接<br>验证 是否有正确的内部结构，并和其他类协调一致<br>准备 负责为类的静态成员分配内存，并设置默认初始化值</li>
<li>初始化<br>初始化成员变量等等</li>
</ul>
<p>加载时机</p>
<ul>
<li>创建类的实例</li>
<li>访问类的静态变量，或者为静态变量赋值</li>
<li>调用类的静态方法</li>
<li>初始化某个类的子类</li>
<li>使用反射方式来强制创建某个类或接口对应的java.lang.Class对象</li>
</ul>
<h4 id="类加载器-classLoader"><a href="#类加载器-classLoader" class="headerlink" title="类加载器 classLoader"></a>类加载器 classLoader</h4><p>负责将.class文件加载到内存中，并为之生成对应的Class对象</p>
<p>类加载器分类</p>
<ul>
<li>根类加载器<br>也被称为引导类加载器，负责Java核心类的加载<br>比如System,String等。在JDK中JRE的lib目录下rt.jar文件中</li>
<li>扩展类加载器<br>负责JRE的扩展目录中jar包的加载<br>在JDK中JRE的lib目录下ext目录</li>
<li>系统类加载器<br>负责在JVM启动时加载来自java命令的class文件<br>以及classpath环境变量所指定的jar包和类路径</li>
</ul>
<h4 id="反射-1"><a href="#反射-1" class="headerlink" title="反射"></a>反射</h4><p>创建一个对象的三个阶段</p>
<ol>
<li>源文件阶段 .java的文件</li>
<li>字节码阶段 .class</li>
<li>创建对象阶段  new  对象名称</li>
</ol>
<p>内省与反射</p>
<ul>
<li>内省<br>在运行时能够获取JavaBean当中的属性名称和get与set方法</li>
<li>反射<br>JAVA反射机制是在运行状态中，对于任意一个类，都能够知道这个类的<strong>所有属性和方法</strong><br>对于任意一个对象，都能够调用它的任意一个方法和属性<br>这种<strong>动态获取的信息以及动态调用对象的方法的功能称为java语言的反射机制</strong></li>
</ul>
<p>获取字节码文件：想要使用反射，就必须得要获取字节码文件</p>
<ol>
<li>Object类的getClass()方法<br>判断两个对象是否是同一个字节码文件</li>
<li>静态属性class<br>当作静态方法的锁对象</li>
<li>Class类中静态方法forName()<br>读取配置文件</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取字节码</span></span><br><span class="line"><span class="comment">// 1.类的全限定名称 ClassNotFoundException</span></span><br><span class="line">Class clazz = Class.forName(<span class="string">"com.it666.reflect.Person"</span>);</span><br><span class="line"><span class="comment">// 2.</span></span><br><span class="line">Class clazz2 = Person.class;</span><br><span class="line"><span class="comment">// 3.</span></span><br><span class="line">Person p = <span class="keyword">new</span> Person();</span><br><span class="line">Class clazz3 = p.getClass();</span><br></pre></td></tr></table></figure>
<h4 id="通过字节码创建对象"><a href="#通过字节码创建对象" class="headerlink" title="通过字节码创建对象"></a>通过字节码创建对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.通过无参构造创建对象</span></span><br><span class="line">Person p2 = (Person)clazz.newInstance();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.通过有参构造创建对象</span></span><br><span class="line"><span class="comment">// 获取字节码的构造器：</span></span><br><span class="line"><span class="comment">// 因为在反射阶段操作的都是字节码，不知道具体的类型，只有在创建对象的时候才去给实际参数</span></span><br><span class="line">Constructor c = clazz.getConstructor(String.class, Integer.class);</span><br><span class="line"><span class="comment">// 通过构造器创建对象：调用构造器的newInstance方法并传入参数</span></span><br><span class="line">Person p2 = (Person)c.newInstance(<span class="string">"al"</span>,<span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<h4 id="获取字段"><a href="#获取字段" class="headerlink" title="获取字段"></a>获取字段</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取pubic字段(默认修饰符是不可以的获取到的：NoSuchFieldException)</span></span><br><span class="line">Field f = clazz.getField(<span class="string">"name"</span>);</span><br><span class="line">f.set(p2,<span class="string">"李白"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取private 字段</span></span><br><span class="line">Field f2 = clazz.getDeclaredField(<span class="string">"age"</span>);</span><br><span class="line"><span class="comment">//private 去除私有权限</span></span><br><span class="line">f2.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">f2.set(p2, <span class="number">11</span>);</span><br></pre></td></tr></table></figure>

<h4 id="获取方法"><a href="#获取方法" class="headerlink" title="获取方法"></a>获取方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取方法</span></span><br><span class="line">Method m1 = clazz.getMethod(<span class="string">"show"</span>);</span><br><span class="line">System.out.println(m1.getName());<span class="comment">//获取名字 </span></span><br><span class="line">m1.invoke(p2);</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取私有方法</span></span><br><span class="line">Method m2 = clazz.getDeclaredMethod(<span class="string">"eat"</span>,String.class);</span><br><span class="line"><span class="comment">//去除私有权限</span></span><br><span class="line">m2.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">m2.invoke(p2, <span class="string">"米饭"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="越过数组泛型检测"><a href="#越过数组泛型检测" class="headerlink" title="越过数组泛型检测"></a>越过数组泛型检测</h4><p>数组如果定义好了泛型就不能添加泛型以外的类型<br>可以通过反射来去实现添加以外的类型<br>在一个Integer泛型的数组当中添加字符串类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">list.add(<span class="number">20</span>);</span><br><span class="line"><span class="comment">// list.add("myxq");</span></span><br><span class="line"><span class="comment">// 错误检测是Eclipse做的，运行的时候会做一个泛型擦除，编译成字节码，泛型都没了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取ArrayList的字节码</span></span><br><span class="line">Class&lt;?&gt; clazz = Class.forName(<span class="string">"java.util.ArrayList"</span>); <span class="comment">// &lt;?&gt;  ?代表任意类型</span></span><br><span class="line">Method m = clazz.getMethod(<span class="string">"add"</span>,Object.class);</span><br><span class="line">m.invoke(list, <span class="string">"myxq"</span>); </span><br><span class="line">System.out.println(list); <span class="comment">// [20, myxq]</span></span><br></pre></td></tr></table></figure>
<h2 id="Tomcat反射加载Servlet"><a href="#Tomcat反射加载Servlet" class="headerlink" title="Tomcat反射加载Servlet"></a>Tomcat反射加载Servlet</h2><p>模拟实现过程<br>新建包com.it666.servlet</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.创建接口</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IServlet</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.创建实现类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstServlet</span> <span class="keyword">implements</span> <span class="title">IServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"init..."</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3.复制web.xml文件，修改servlet-class标签为：com.it666.servlet.FirstServlet</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.测试类模拟Tomcat反射加载Servlet</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> DocumentException, ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, SecurityException, IllegalArgumentException, InvocationTargetException </span>&#123;</span><br><span class="line">		<span class="comment">//加载web.xml 使用dom4j</span></span><br><span class="line">		<span class="comment">// 1.创建SAXReader</span></span><br><span class="line">		SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">		Document doc = reader.read(<span class="string">"src/web.xml"</span>); <span class="comment">// DocumentException</span></span><br><span class="line">		<span class="comment">// 获取根元素</span></span><br><span class="line">		Element rootElement = doc.getRootElement();</span><br><span class="line">		System.out.println(rootElement);</span><br><span class="line">		</span><br><span class="line">		List &lt;Element&gt; list = rootElement.elements(<span class="string">"servlet"</span>);</span><br><span class="line">		<span class="keyword">for</span> (Element ServEle : list) &#123;</span><br><span class="line">			Element classEle = ServEle.element(<span class="string">"servlet-class"</span>);</span><br><span class="line">			System.out.println(classEle.getText());</span><br><span class="line">			<span class="comment">//</span></span><br><span class="line">			Class clazz = Class.forName(classEle.getText()); <span class="comment">// ClassNotFoundException</span></span><br><span class="line">			Object obj = clazz.newInstance();<span class="comment">// InstantiationException</span></span><br><span class="line">			</span><br><span class="line">			Method m = clazz.getMethod(<span class="string">"init"</span>);<span class="comment">// NoSuchMethodException</span></span><br><span class="line">			m.invoke(obj); <span class="comment">//IllegalArgumentException</span></span><br><span class="line">			<span class="comment">// 输出：init...</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h2><p>Servlet什么时候被创建</p>
<ol>
<li>默认情况下第一次访问的时候创建</li>
<li>可以通过配置文件设置服务器启动的时候就创建</li>
</ol>
<ul>
<li>init<br>servlet对象创建的时候调用<br>默认第一次访问时创建</li>
<li>service<br>每次请求都会执行一次</li>
<li>destroy<br>servlet对象销毁的时候执行<br>默认服务器关闭时销毁</li>
<li>load-on-startup标签<br>对象在服务器启动时就创建<br>值为数字代表优先级：数据越小，优先级越高，不能为负数<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--load-on-startup在web.xml的servlet标签中--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myxq<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.it666.servlet.FirstServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>3<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Servlet访问流程"><a href="#Servlet访问流程" class="headerlink" title="Servlet访问流程"></a>Servlet访问流程</h2><p>ServletRequest对象和ServletResponse对象是引擎提前创建好的<br>每次请求时调用service方法并把这两个对象传入<br><img src="/2020/02/07/web-server-note-3/3.png" alt="Servlet访问流程"></p>
<h2 id="Servlet配置信息"><a href="#Servlet配置信息" class="headerlink" title="Servlet配置信息"></a>Servlet配置信息</h2><p>init-params标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myxq<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.it666.servlet.FirstServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>3<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- init-params标签 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>my<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">	<span class="comment">// 1.获取web.xml的Servlet名称</span></span><br><span class="line">	System.out.println(config.getServletName());<span class="comment">// 获取&lt;servlet-name&gt; 输出：myxq</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 2.获取一些初始化参数 web.xml</span></span><br><span class="line">	String value = config.getInitParameter(<span class="string">"my"</span>);</span><br><span class="line">	System.out.println(value);<span class="comment">// 输出：1234</span></span><br><span class="line">	<span class="comment">// 3.获取ServletContext</span></span><br><span class="line">	ServletContext sc = config.getServletContext();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>init方法的config参数<br>该servlert的配置信息<br>获得web.xml当中参数<br>初始化参数<br>获取servletContext对象</p>
<p>url-patten</p>
<ol>
<li>完全匹配</li>
<li>目录匹配</li>
<li>扩展名匹配<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>myxq<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/firstServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/aaa/bbb/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.myxq<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>缺省Servlet<br>访问的资源不存在时，就会找缺省的地址</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">url-patten</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-patten</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>全局Web.xml<br>对于部署在服务器上的所有应用都有效<br>先到自己工程当中找web.xml配置<br>再到全局web.xml当中去找配置<br>如果两个当中有相同的配置，自己当中配置的内容会生效</p>
<p>静态资源加载过程<br>在path后面写的静态资源名称index.html或者是其它的.html它都是会找ur-patten当中有没有匹配的内容<br>如果有，就加载对应的servlet，如果没有就到自己配置当中找缺省的url-patten<br>如果自己配置文件当中没有缺省的，就会找全局配置缺省的url-patten<br>在全局配置当中有一个缺省的url-patten 对应的是default的Servlet<br>defaultServlet内部会到当前访问的工程根目录当中去找对应的名称的静态资源，如果有，就把里面的内容逐行读出。响应给浏览器，如果没有，就会报404错误</p>
<p>欢迎页面 Welcome-file-list<br>不写任何资源名称的时候，会访问欢迎页面<br>默认从上往下找</p>
<h2 id="使用注解创建Servlet"><a href="#使用注解创建Servlet" class="headerlink" title="使用注解创建Servlet"></a>使用注解创建Servlet</h2><p>包名右键-new-Servlet<br><img src="/2020/02/07/web-server-note-3/4.png" alt="new Servlet"><br><img src="/2020/02/07/web-server-note-3/5.png" alt="new Servlet2"><br><img src="/2020/02/07/web-server-note-3/6.png" alt="new Servlet3"></p>
<p>修改web.xml web-app标签中的 metadata-complete=”false”<br>该属性为true时，web应用将不会加载注解配置的Web组件</p>
<p>从Servlet3.0开始可以直接使用注解的形式来去使用Servlet<br>在创建好的Servlet上面有会有一个@WebServlet(“/myServlet”)<br>这个就是一个注解，就相当于在代码上添加了一个小插件<br>贴上这个注解后，就不用再去做配置文件，会在内部自动帮你去做<br>括号当中的内容就是url-patten的内容，要在地址栏当中path后面跟的内容</p>
<h2 id="HttpServlet"><a href="#HttpServlet" class="headerlink" title="HttpServlet"></a>HttpServlet</h2><p>直接new的Servlet它是一个HttpServlet<br>它是GenericServlet的子类<br>GenericServlet实现了Servlet接口<br>HttpServlet是专门负责处理http请求与响应的<br>以后创建Servlet时，直接使用httpServlet</p>
<h4 id="HttpServlet方法"><a href="#HttpServlet方法" class="headerlink" title="HttpServlet方法"></a>HttpServlet方法</h4><ul>
<li>service<br>每一次发送请求的时候就会调用<br>当写了service就会不再调用get或post</li>
<li>doGet<br>当发送get请求时调用</li>
<li>doPost<br>当发送post请求的时候调用</li>
</ul>
<h4 id="内部方法调用过程"><a href="#内部方法调用过程" class="headerlink" title="内部方法调用过程"></a>内部方法调用过程</h4><p>当接收到一个请求时， tomcat就会找对应的service方法<br>如果当中servlet当中没有存在service方法，就会到它的父类(HttpServlet)当中去找<br><img src="/2020/02/07/web-server-note-3/7.png" alt="HttpServlet"><br>在父类当中找到service是参数为ServletRequest，在会内部把参数转为httpServlet<br>转换完毕后会再继续调用参数为httpServletRequest的service方法<br><img src="/2020/02/07/web-server-note-3/8.png" alt="HttpServlet2"><br>在此方法当中会获取参数的类型，根据不同的参数类型再去调用不同的方法</p>
</section>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/avatar.jpg">
        <div>
            <span class="dark">Aaron Lin</span>
            <span></span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" href="https://twitter.com/intent/tweet?text=https://aaronlinv.github.io/2020/02/07/web-server-note-3/ - Web服务器笔记-Servlet @" target="_blank" rel="noopener"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">加载评论</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "Web服务器笔记-Servlet",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
    <div id="social">
        <p class="small">©
            Aaron Lin | Powered by Hexo &
                <a href="https://github.com/F0r3at/Lights" target="_blank" rel="noopener"> Lights</a>
        </p>
    </div>
</footer>
</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



