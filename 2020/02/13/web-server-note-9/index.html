<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="Java Server Pages  (Java服务器页面)在传统的网页HTML文件(.htm,.html)中插入Java程序段和JSP标记，后缀名为(*.jsp)其根本是一个简化的Servlet设计
为什么要有JSP直接使用html文件是没有办法输出Java当中的信息使用Servlet来去输出一个">


<link rel="alternate" href="/atom.xml" title="Aaron Lin" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>Web服务器笔记-JSP - Aaron Lin</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->


<!-- <link rel="shortcut icon" href="/favicon.png"> -->

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/css/style.css">
<!-- 谷歌 Analytics -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-153099566-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-153099566-1');
</script>


<nav class="main-nav">
	
	    <a href="/">← 主页</a>
	
	
	    <a href="/about/">关于</a>
	
	    <a href="/archives/">归档</a>
	
	<a class="cta" href="/rss2.xml" data-no-instant>订阅</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>Web服务器笔记-JSP</h1>
        
        <h2 class="headline">Feb 13 2020
        
            
            <a href="/categories/Web服务器笔记/#Web服务器笔记">Web服务器笔记</a>
        
        </h2>
    </header>
</article>
<section id="post-body"><h4 id="Java-Server-Pages-Java服务器页面"><a href="#Java-Server-Pages-Java服务器页面" class="headerlink" title="Java Server Pages  (Java服务器页面)"></a>Java Server Pages  (Java服务器页面)</h4><p>在传统的网页HTML文件(<em>.htm,</em>.html)中插入Java程序段和JSP标记，后缀名为(*.jsp)<br>其根本是一个简化的Servlet设计</p>
<p>为什么要有JSP<br>直接使用html文件是没有办法输出Java当中的信息<br>使用Servlet来去输出一个网页非常的麻烦<br>于是就出现了JSP，又能写html，又能写Java代码</p>
<p>修改JSP编码<br><img src="/2020/02/13/web-server-note-9/1.png" alt="修改JSP编码"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"ISO-8859-1"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String name = <span class="string">"蚂蚁小强"</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;h1&gt;</span><br><span class="line">&lt;%=name %&gt;</span><br><span class="line">&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


<h4 id="JSP的工作原理"><a href="#JSP的工作原理" class="headerlink" title="JSP的工作原理"></a>JSP的工作原理</h4><p>本质就是一个servlet</p>
<p>JSP在第一次被访问时会被Web容器翻译成Servlet</p>
<ul>
<li>第一次访问index.jsp，自动翻译成index_jsp.java（本质就是把标签一行一行write出来）</li>
</ul>
<p><img src="/2020/02/13/web-server-note-9/2.png" alt="index_jsp.java"></p>
<ul>
<li>编译成index_jsp.class运行</li>
<li>可以在Tomcat的work目录中可以找到(test_jsp.class和test_jsp.java)</li>
<li>下次一次访问时， 会看一下里面的内容有没有发生变化，如果变化了， 重新翻译加载</li>
</ul>
<p><img src="/2020/02/13/web-server-note-9/3.png" alt="index_jsp.java"></p>
<p>全局web.xml中有一个配置，所有JSP的翻译由JspServlet来做</p>
<h2 id="JSP的组成部分"><a href="#JSP的组成部分" class="headerlink" title="JSP的组成部分"></a>JSP的组成部分</h2><ul>
<li>静态数据，如HTML</li>
<li>JSP脚本元素和变量</li>
<li>JSP指令，如include指令</li>
<li>JSP标签动作</li>
<li>用户自定义标签</li>
</ul>
<h2 id="JSP脚本元素和变量"><a href="#JSP脚本元素和变量" class="headerlink" title="JSP脚本元素和变量"></a>JSP脚本元素和变量</h2><p>&lt;%java代码%&gt;<br>内部的java代码翻译到Service方法的内部</p>
<p>&lt;%=java变量或表达式&gt;<br>会被翻译成Service方法内部out.print()</p>
<p>&lt;%!java代码%&gt;<br>会被翻译成Servlet的<strong>成员</strong></p>
<p>JSP注释<br>HTML注释：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注释内容--&gt;</span></span><br></pre></td></tr></table></figure>
<p>可见范围JSP源码、翻译后的Servlet、页面</p>
<p>Java注释<br>//单行注释  /<em>多行注释</em>/<br>可见范围JSP源码、翻译后的Servlet，页面中看不到</p>
<p>JSP注释<br>&lt;%–注释内容–%&gt;<br>仅JSP源码可见</p>
<h2 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h2><p>用于设置整个JSP页面的相关信息<br>以及用于JSP页面与其它容器之间的通信</p>
<h4 id="include指令"><a href="#include指令" class="headerlink" title="include指令"></a>include指令</h4><p>表示在JSP编译时插入一个包含文件或者代码的文件<br>include指令所包含的文件名不能是一个变量url，只能是静态的文件名<br>静态包含：将两个JSP页面接着到一起，然后再翻译成Servlet</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span></span><br><span class="line">    pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">	&lt;%@ include file=<span class="string">"/header.jsp"</span> %&gt;</span><br><span class="line">	&lt;h1&gt;主体&lt;/h1&gt;</span><br><span class="line">	&lt;%@ include file=<span class="string">"/footer.jsp"</span> %&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h4 id="page指令"><a href="#page指令" class="headerlink" title="page指令"></a>page指令</h4><p>用于设定整个JSP页面的属性和相关功能，多个属性之间使用空格隔开<br>page指令共有11个属性</p>
<ul>
<li>contentType<br>指定JSP页面的MIME和编码格式</li>
<li>pageEncoding<br>指定JSP文件的编码格式</li>
<li>import<br>在JSP中引入Java的包和类，多个包之间以逗号隔开<br>（Ctrl+Shift+O 导包无效，写java.util. 再Alt+/导包）</li>
<li>session<br>指定当前页面是否能获得当前用户的session对象，缺省是true<br>如果指定为false，那么在该页面中无法使用session，使用的话会提示500错误</li>
<li>errorPage<br>如果当前页面发生异常<br>网页会重定向到errorPage所指定的页面进行处理</li>
<li>isErrorPage<br>允许指定的JSP页面为错误处理页面</li>
<li>language属性<br>指定页面中使用的脚本语言种类<br>目前只支持Java</li>
<li>extends<br>用于指定该JSP生成的Servlet继承自哪个父类<br>必须指定包名加类名</li>
<li>buffer<br>用来设置输出流缓冲区<br>缓冲区的作用就是为了提高IO性能<br>也就是说减少write的次数</li>
<li>autoFlush<br>用来指定当输出流缓冲区满了的时候，是否自动刷新缓冲区</li>
<li>isThreadSafe<br>缺省值为true<br>指定该JSP文件是否支持多线程访问</li>
<li>info<br>用来设置该JSP文件的介绍信息</li>
<li>isELIgnored<br>用来标示是否支持EL表达式</li>
</ul>
<h4 id="taglib指令"><a href="#taglib指令" class="headerlink" title="taglib指令"></a>taglib指令</h4><p>声明JSP文件使用哪些标签库</p>
<p>有哪些标签库</p>
<ul>
<li>JSP标准标签库</li>
<li>第三方标签库</li>
<li>自定义标签库</li>
</ul>
<h2 id="标签动作"><a href="#标签动作" class="headerlink" title="标签动作"></a>标签动作</h2><p>页面包含</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page="被包含的页面"&gt;&lt;/jsp:include&gt;</span><br><span class="line">&lt;jsp:include page="/header.jsp"&gt;&lt;/jsp:include&gt;</span><br></pre></td></tr></table></figure>
<p>动态包含：各自翻译自己的页面，然后再引入<br>与include对比<br><img src="/2020/02/13/web-server-note-9/4.png" alt="与include对比"></p>
<p>请求转发（地址栏不会发生变化）<br>&lt;jsp:forward page=”要转发的资源”&gt;<br>&lt;jsp:forward page=”/test.jsp”&gt;</p>
<h2 id="隐式对象"><a href="#隐式对象" class="headerlink" title="隐式对象"></a>隐式对象</h2><p>JSP被翻译成servlet之后，service方法中有9个对象定义并初始化完毕<br><img src="/2020/02/13/web-server-note-9/5.png" alt="隐式对象"><br>还有一个是异常的对象</p>
<h4 id="可以直接使用这9个对象"><a href="#可以直接使用这9个对象" class="headerlink" title="可以直接使用这9个对象"></a>可以直接使用这9个对象</h4><ul>
<li>request<br>得到用户请求信息对象</li>
<li>response<br>服务器向客户端的响应对象</li>
<li>config<br>服务器配置，可以取得初始化参数</li>
<li>session<br>用来保存用户会话的信息</li>
<li>application<br>所有用户的共享信息，就是servletContext</li>
<li>page<br>指当前页面转换后的Servlet类的实例</li>
<li>out<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aaa</span><br><span class="line">&lt;%=<span class="string">"bbb"</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	out.write(<span class="string">"ccc"</span>);</span><br><span class="line">	response.getWriter().write(<span class="string">"ddd"</span>);</span><br><span class="line">	</span><br><span class="line">%&gt;</span><br><span class="line">打印顺序：ddd aaa bbb ccc</span><br></pre></td></tr></table></figure>
out的类型：JspWriter<br>out作用就是向客户端输出内容 out.write()<br>out缓冲区默认8kb<br>可以设置成0 代表关闭out缓冲区内容直接写到respons缓冲区<br>out写的内容写到out缓冲区当中<br>最后再把out缓冲区当中的内容合并到response缓冲区中（拼接到后面）<br><img src="/2020/02/13/web-server-note-9/6.png" alt="out"></li>
<li>pageContext<br>JSP页面的上下文对象<br>是一个域对象<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setAttribute(String name,Object obj)</span><br><span class="line">getAttribute(String name)</span><br><span class="line">removeAttrbute(String name)</span><br></pre></td></tr></table></figure>
可以向指定的其他域中存取数据<br>自动到所有的域当中找数据<br>从小到大的范围搜索数据<br>依次从pageContext域，request域，session域，application域中获取属性<br>在某个域中获取后将不在向后寻找<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">setAttribute(String name,Object obj,<span class="keyword">int</span> scope)</span><br><span class="line">setAttribute(“name”,<span class="string">"lk"</span>,PageContext.REQUEST_SCOPE);</span><br><span class="line">getAttribute(String name,<span class="keyword">int</span> scope)</span><br><span class="line">getAttribute(<span class="string">"lk"</span>,PageContext.REQUEST_SCOPE)</span><br><span class="line">removeAttrbute(String name,<span class="keyword">int</span> scope)</span><br><span class="line">findAttribute(String name)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>可以获得其他8大隐式对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pageContext.getRequest()</span><br><span class="line">pageContext.getSession()</span><br></pre></td></tr></table></figure>
<ul>
<li>exception<br>表示JSP页面所发生的异常，在错误页中才起作用<br>只有是错误页面的时候，才会有该对象</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://study.163.com/course/introduction/1005981003.htm" target="_blank" rel="noopener">Java零基础到高级JavaWeb与项目</a></p>
</section>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/avatar.jpg">
        <div>
            <span class="dark">Aaron Lin</span>
            <span></span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" href="https://twitter.com/intent/tweet?text=https://aaronlinv.github.io/2020/02/13/web-server-note-9/ - Web服务器笔记-JSP @" target="_blank" rel="noopener"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">加载评论</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "Web服务器笔记-JSP",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
    <div id="social">
        <p class="small">©
            Aaron Lin | Powered by Hexo &
                <a href="https://github.com/F0r3at/Lights" target="_blank" rel="noopener"> Lights</a>
        </p>
    </div>
</footer>
</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



