<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Docker 实践及命令梳理 | Aaron Lin</title>
<meta name=keywords content><meta name=description content='下一节：Dockerfile 实践及梳理

文档
Docker Reference Documentation
Docker 从入门到实践 【中文】
安装
安装 Docker，设置开机启动，然后配置阿里云镜像加速
1. 安装 Docker
Docker 官方安装
CentOS 官方安装教程，直接安装速度相对慢，推荐使用 使用脚本自动安装 Docker：
curl -fsSL get.docker.com -o get-docker.sh
sudo sh get-docker.sh --mirror Aliyun
# 开机启动 docker
sudo systemctl enable docker
# 启动 docker
sudo systemctl start docker
2. 阿里云镜像加速
注意！registry-mirrors 需要替换成自己的 阿里云镜像加速器地址，通过点击地址获取
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-&#39;EOF&#39;
{
  "registry-mirrors": ["这里替换成自己的阿里云镜像加速器地址"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
Docker CLI
CLI 是 Command-Line Interface （命令行界面）的缩写
命令详情可以参考官方文档：Docker Reference Documentation'><meta name=author content><link rel=canonical href=https://aaronlinv.github.io/posts/docker-%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%91%BD%E4%BB%A4%E6%A2%B3%E7%90%86/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://aaronlinv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://aaronlinv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://aaronlinv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://aaronlinv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://aaronlinv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://aaronlinv.github.io/posts/docker-%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%91%BD%E4%BB%A4%E6%A2%B3%E7%90%86/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://aaronlinv.github.io/posts/docker-%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%91%BD%E4%BB%A4%E6%A2%B3%E7%90%86/"><meta property="og:site_name" content="Aaron Lin"><meta property="og:title" content="Docker 实践及命令梳理"><meta property="og:description" content='下一节：Dockerfile 实践及梳理
文档 Docker Reference Documentation
Docker 从入门到实践 【中文】
安装 安装 Docker，设置开机启动，然后配置阿里云镜像加速
1. 安装 Docker Docker 官方安装
CentOS 官方安装教程，直接安装速度相对慢，推荐使用 使用脚本自动安装 Docker：
curl -fsSL get.docker.com -o get-docker.sh sudo sh get-docker.sh --mirror Aliyun # 开机启动 docker sudo systemctl enable docker # 启动 docker sudo systemctl start docker 2. 阿里云镜像加速 注意！registry-mirrors 需要替换成自己的 阿里云镜像加速器地址，通过点击地址获取
sudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json <<-&#39;EOF&#39; { "registry-mirrors": ["这里替换成自己的阿里云镜像加速器地址"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker Docker CLI CLI 是 Command-Line Interface （命令行界面）的缩写 命令详情可以参考官方文档：Docker Reference Documentation'><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-08-11T23:19:33+08:00"><meta property="article:modified_time" content="2021-08-11T23:19:33+08:00"><meta property="og:image" content="https://aaronlinv.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://aaronlinv.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Docker 实践及命令梳理"><meta name=twitter:description content='下一节：Dockerfile 实践及梳理

文档
Docker Reference Documentation
Docker 从入门到实践 【中文】
安装
安装 Docker，设置开机启动，然后配置阿里云镜像加速
1. 安装 Docker
Docker 官方安装
CentOS 官方安装教程，直接安装速度相对慢，推荐使用 使用脚本自动安装 Docker：
curl -fsSL get.docker.com -o get-docker.sh
sudo sh get-docker.sh --mirror Aliyun
# 开机启动 docker
sudo systemctl enable docker
# 启动 docker
sudo systemctl start docker
2. 阿里云镜像加速
注意！registry-mirrors 需要替换成自己的 阿里云镜像加速器地址，通过点击地址获取
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-&#39;EOF&#39;
{
  "registry-mirrors": ["这里替换成自己的阿里云镜像加速器地址"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
Docker CLI
CLI 是 Command-Line Interface （命令行界面）的缩写
命令详情可以参考官方文档：Docker Reference Documentation'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://aaronlinv.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Docker 实践及命令梳理","item":"https://aaronlinv.github.io/posts/docker-%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%91%BD%E4%BB%A4%E6%A2%B3%E7%90%86/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Docker 实践及命令梳理","name":"Docker 实践及命令梳理","description":"下一节：Dockerfile 实践及梳理\n文档 Docker Reference Documentation\nDocker 从入门到实践 【中文】\n安装 安装 Docker，设置开机启动，然后配置阿里云镜像加速\n1. 安装 Docker Docker 官方安装\nCentOS 官方安装教程，直接安装速度相对慢，推荐使用 使用脚本自动安装 Docker：\ncurl -fsSL get.docker.com -o get-docker.sh sudo sh get-docker.sh --mirror Aliyun # 开机启动 docker sudo systemctl enable docker # 启动 docker sudo systemctl start docker 2. 阿里云镜像加速 注意！registry-mirrors 需要替换成自己的 阿里云镜像加速器地址，通过点击地址获取\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u0026lt;\u0026lt;-\u0026#39;EOF\u0026#39; { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;这里替换成自己的阿里云镜像加速器地址\u0026#34;] } EOF sudo systemctl daemon-reload sudo systemctl restart docker Docker CLI CLI 是 Command-Line Interface （命令行界面）的缩写 命令详情可以参考官方文档：Docker Reference Documentation\n","keywords":[],"articleBody":"下一节：Dockerfile 实践及梳理\n文档 Docker Reference Documentation\nDocker 从入门到实践 【中文】\n安装 安装 Docker，设置开机启动，然后配置阿里云镜像加速\n1. 安装 Docker Docker 官方安装\nCentOS 官方安装教程，直接安装速度相对慢，推荐使用 使用脚本自动安装 Docker：\ncurl -fsSL get.docker.com -o get-docker.sh sudo sh get-docker.sh --mirror Aliyun # 开机启动 docker sudo systemctl enable docker # 启动 docker sudo systemctl start docker 2. 阿里云镜像加速 注意！registry-mirrors 需要替换成自己的 阿里云镜像加速器地址，通过点击地址获取\nsudo mkdir -p /etc/docker sudo tee /etc/docker/daemon.json \u003c\u003c-'EOF' { \"registry-mirrors\": [\"这里替换成自己的阿里云镜像加速器地址\"] } EOF sudo systemctl daemon-reload sudo systemctl restart docker Docker CLI CLI 是 Command-Line Interface （命令行界面）的缩写 命令详情可以参考官方文档：Docker Reference Documentation\n这里通过几个场景，把 Docker 先用起来\n场景0：Tomcat # 输入 docker 回车，docker 的命令会被罗列出来，便于查询 docker # 查询有那些 MySQL 镜像 docker search tomcat 相对于直接search，使用搜索 Docker Hub 更方便\n搜索 Tomcat\n可以看到相关的镜像介绍、使用帮助、历史版本：Tomcat\n可以按照文档中的 “How to use this image” 的提示来运行镜像\n# 拉取 tomcat 镜像 docker pull tomcat:8.0-jre8 # 查看镜像列表，可以看到 tomcat 镜像，该命令等特于：docker image ls docker images # 运行tomcat 镜像 docker run tomcat:8.0-jre8 # 前台运行，会输出 tomcat 日志 # 按 Ctrl + C 停止 # 添加 -d 后台运行参数 docker run -d tomcat:8.0-jre8 # 查看容器列表，可以查看到容器的id、镜像(IMAGE)、状态(STATUS)、网络端口(PROT)、容器名称(NAME)等信息 docker ps # 查看 tomcat 日志，这里的 `clever_swanson` 为容器id或名称 docker logs clever_swanson # 查看容器内部进程信息 docker top clever_swanson # 进入容器 # i 和 t 参数可以让我们以伪终端的方式进入容器 # bash 是所使用 shell docker exec -it clever_swanson bash # 在容器内可以使用 Linux 命令 # 退出容器，回到宿主机（宿主机就是安装 Docker 的这台机器） exit # 不需要容器了，可以停止容器 docker stop clever_swanson # 查看容器列表，tomcat 就隐藏了 docker ps # -a 参数查看全部所有容器的列表（包括停止的 tomcat） docker ps -a # 启动已经停止的容器 docker start clever_swanson # 删除容器，如果容器还在运行需要加 -f 参数 docker rm clever_swanson docker rm -f clever_swanson # 删除了容器，就可以把镜像也删除了，如果有容器还是该镜像需要加 -f 参数 docker rmi tomcat:8.0-jre8 docker rmi -f tomcat:8.0-jre8 场景1：Tomcat 只是将 Tomcat 容器 run 起来，还是无法满足使用 还需要将容器网络端口映射到宿主机才可以使得外部可以访问容器内部服务 为了方便还需要把 Tomcat 的数据目录和配置目录挂载到宿主机，方便直接进行编辑\n可参考官方文档：Tomcat\n# 部署 Tomcat # run 容器时，本地不存在对应镜像，会自动 pull # -p 将容器内的网络端口映射到宿主机 ，8080:8080 前面为宿主机，后面为容器 # --name 指定容器名称 docker run -p 8080:8080 -d --name mytomcat tomcat:8.0-jre8 # 可以通过 docker 的子命令对 容器进行操作，比如：ps,exec,top,stop # 这个容器已经占用了宿主机的 8080 端口，为了后续的 Tomcat 可以绑定到宿主机的 8080 端口，所以将 这个容器 stop docker stop mytomcat # 通过数据卷的方式 将容器内的数据映射到宿主机 # 语法：- v 数据卷名称:容器内目录 # Tomcat 部署的 web应用目录：/usr/local/tomcat/webapps # 配置文件：/usr/local/tomcat/conf docker run -p 8080:8080 -v apps:/usr/local/tomcat/webapps -v confs:/usr/local/tomcat/conf -d --name mytomcat2 tomcat:8.0-jre8 这个时候 Tomcat 已经启动了，可以通过 http://ip宿主机:8080 来访问 Tomcat 的默认主页，例如我的访问地址 http://192.168.43.166:8080 ，看到汤姆猫的图标就成功了。如果访问失败，可能是对应的 8080 端口没有开放，CentOS7 可以参考：CentOS7开启端口\n场景2：MySQL 可参考官方文档：MySQL\n# 通过 -e 指定参数，指定 MySQL 的 root 账户的密码为：1234 docker run --name mysql -e MYSQL_ROOT_PASSWORD=1234 -p 3306:3306 -d mysql:5.7.32 # 停止容器，防止端口占用 docker stop mysql # 数据库的数据将会随着容器消失而消失，所以需要将数据库文件持久化到宿主机， # 配置映射到本地 docker run --name mysql2 -e MYSQL_ROOT_PASSWORD=1234 -p 3306:3306 -d -v mysqldata:/var/lib/mysql -v mysqlconfig:/etc/mysql mysql:5.7.32 MySQL 就成功运行了，可以通过 Navicat 或者其他工具测试数据库，地址为宿主机 ip地址，用户名为 root，密码为：1234，可以尝试存储数据，数据会被存储在数据卷，这里指定的数据卷名称为：mysqldata\n# 查看所有数据卷 docker volume ls # 查看 MySQL 的数据卷 docker inspect mysqldata # 返回的 json 对象，其中 Mountpoint 的值就是，文件对应挂载的位置 # 我这里挂载的地址为：/var/lib/docker/volumes/mysqldata/_data # 进入这个目录，就可以看到存储的文件 使用数据卷的好处在于：容器被移除了，重新运行一个新容器，直接挂载原来的数据卷就可了，数据不会丢失\n# 移除容器 docker rm -f mysql2 # 重新运行新的容器，并挂载原来的数据卷 docker run --name mysql2 -e MYSQL_ROOT_PASSWORD=1234 -p 3306:3306 -d -v mysqldata:/var/lib/mysql -v mysqlconfig:/etc/mysql mysql:5.7.32 Redis 可参考官方文档：Redis\n需要注意的是：Redis 需要在镜像名称即 redis:5.0.10 的后面添加 redis-server --appendonly yes ，以此覆盖镜像默认的命令\ndocker run --name redis -p 6379:6379 -d redis:5.0.10 # 停止容器，防止端口占用 docker stop redis # 开启持久化 redis-server --appendonly yes # 开启后，持久化生成的 aop 文件会被放入容器中的 /data 目录中 docker run --name redis2 -p 6379:6379 -d -v redisdata:/data redis:5.0.10 redis-server --appendonly yes # 可以使用 Redis Desktop Manager 等工具，通过宿主机 ip 连接，进行测试 清理容器 # 查看容器列表可以看到很多容器 docker ps # -a 可以看到所有的容器，包括已经停止的 docker ps -a # 如果忘记了参数或者命令可以在命令后面加上 --help，会有提示 docker ps --help # 可以看到：-q, --quiet Only display container IDs，即：-q参数仅输出容器id，结合 -a，可以输出所有容器的 id docker ps -aq # 结合 rm -f 就可以移除所有的容器了 docker rm -f $(docker ps -aq) # 清除没有用到的数据卷，有重要数据要谨慎 docker volume prune docker 我们可以通过下面的命令，来找到 docker 的位置\nwhereis docker # 我这里执行返回的结果是：docker: /usr/bin/docker /etc/docker /usr/libexec/docker /usr/share/man/man1/docker.1.gz 可以看到 docker 的可执行文件位于 /usr/bin，这个路径存在环境变量 PATH 中，所以我们可以在任意路径 使用 docker 命令\nDocker 是 C/S 架构模式（客户端-服务器），所以上面的 docker 实际上是 Docker 的客户端，Docker 的服务器是 Docker Deamon 对应的就是 dockerd，也在这个目录下，Deamon 就是 Docker 引擎，Docker 客户端通过 Docker API 与 Deamon 进行通信\ndocker 是一个可执行程序，包含了许多命令，输入\ndocker --help 会将 Usage（用法）、Option（选项）、Commands（命令）都展示出来，Management Commands 也s是 Commands。每个命令可能会有它自己的子命令、选项\n# run 命令有许多的选项 docker run --help # volume 命令有许多子命令，例如：ls, rm, inspect docker volume --help 命令梳理 使用 --help 参数，就可以查询到到对应命令的使用方法，所以我们只要理解 Docker 命令的框架即可，不用记忆命令细节 对镜像进行操作：images, rmi, search 对容器进行操作：run, stop, start, restart, exec, logs, top 其他：ps, cp, info, pull, version\n还有一些 Management Commands，例如：image, network, volume 这些命令都是名词，即要操作的对象，而具体的操作通过其子命令指定，语义更加清晰 image 常用子命令：ls, rm, prune network 常用子命令：create, ls, inspect, rm, prune volume 常用子命令：同上面 network 的四个\n参考资料 Install docker using the convenience script 【编程不良人】Docker容器技术\u0026Docker-Compose实战 Docker组件 Docker 组件之间的关系\n下一节：Dockerfile 实践及梳理\n","wordCount":"640","inLanguage":"en","image":"https://aaronlinv.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2021-08-11T23:19:33+08:00","dateModified":"2021-08-11T23:19:33+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://aaronlinv.github.io/posts/docker-%E5%AE%9E%E8%B7%B5%E5%8F%8A%E5%91%BD%E4%BB%A4%E6%A2%B3%E7%90%86/"},"publisher":{"@type":"Organization","name":"Aaron Lin","logo":{"@type":"ImageObject","url":"https://aaronlinv.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://aaronlinv.github.io/ accesskey=h title="Aaron's Blog (Alt + H)">Aaron's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://aaronlinv.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://aaronlinv.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://aaronlinv.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://aaronlinv.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Docker 实践及命令梳理</h1><div class=post-meta><span title='2021-08-11 23:19:33 +0800 +0800'>August 11, 2021</span></div></header><div class=post-content><p>下一节：<a href=https://www.cnblogs.com/aaronlinv/p/15213211.html>Dockerfile 实践及梳理</a></p><hr><h2 id=文档>文档<a hidden class=anchor aria-hidden=true href=#文档>#</a></h2><p><a href=https://docs.docker.com/reference/>Docker Reference Documentation</a></p><p><a href=https://vuepress.mirror.docker-practice.com/>Docker 从入门到实践 【中文】</a></p><h2 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h2><p>安装 Docker，设置开机启动，然后配置阿里云镜像加速</p><h3 id=1-安装-docker>1. 安装 Docker<a hidden class=anchor aria-hidden=true href=#1-安装-docker>#</a></h3><p><a href=https://docs.docker.com/get-docker/>Docker 官方安装</a></p><p><a href=https://docs.docker.com/engine/install/centos/>CentOS 官方安装教程</a>，直接安装速度相对慢，推荐使用 <a href=https://vuepress.mirror.docker-practice.com/install/centos/#%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E8%87%AA%E5%8A%A8%E5%AE%89%E8%A3%85>使用脚本自动安装 Docker</a>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -fsSL get.docker.com -o get-docker.sh
</span></span><span class=line><span class=cl>sudo sh get-docker.sh --mirror Aliyun
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 开机启动 docker</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> docker
</span></span><span class=line><span class=cl><span class=c1># 启动 docker</span>
</span></span><span class=line><span class=cl>sudo systemctl start docker
</span></span></code></pre></div><h3 id=2-阿里云镜像加速>2. 阿里云镜像加速<a hidden class=anchor aria-hidden=true href=#2-阿里云镜像加速>#</a></h3><p>注意！<code>registry-mirrors</code> 需要替换成自己的 <a href=https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors>阿里云镜像加速器地址</a>，通过点击地址获取</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mkdir -p /etc/docker
</span></span><span class=line><span class=cl>sudo tee /etc/docker/daemon.json <span class=s>&lt;&lt;-&#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>{
</span></span></span><span class=line><span class=cl><span class=s>  &#34;registry-mirrors&#34;: [&#34;这里替换成自己的阿里云镜像加速器地址&#34;]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>sudo systemctl restart docker
</span></span></code></pre></div><h2 id=docker-cli>Docker CLI<a hidden class=anchor aria-hidden=true href=#docker-cli>#</a></h2><p>CLI 是 Command-Line Interface （命令行界面）的缩写
命令详情可以参考官方文档：<a href=https://docs.docker.com/engine/reference/commandline/cli/>Docker Reference Documentation</a></p><p>这里通过几个场景，把 Docker 先用起来</p><h3 id=场景0tomcat>场景0：Tomcat<a hidden class=anchor aria-hidden=true href=#场景0tomcat>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 输入 docker 回车，docker 的命令会被罗列出来，便于查询</span>
</span></span><span class=line><span class=cl>docker
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查询有那些 MySQL 镜像</span>
</span></span><span class=line><span class=cl>docker search tomcat
</span></span></code></pre></div><p>相对于直接search，使用搜索 <a href=https://hub.docker.com/>Docker Hub</a> 更方便</p><p>搜索 <a href="https://hub.docker.com/search?q=tomcat&amp;type=image">Tomcat</a></p><p>可以看到相关的镜像介绍、使用帮助、历史版本：<a href=https://hub.docker.com/_/tomcat>Tomcat</a></p><p>可以按照文档中的 &ldquo;How to use this image&rdquo; 的提示来运行镜像</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 拉取 tomcat 镜像</span>
</span></span><span class=line><span class=cl>docker pull tomcat:8.0-jre8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看镜像列表，可以看到 tomcat 镜像，该命令等特于：docker image ls</span>
</span></span><span class=line><span class=cl>docker images
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 运行tomcat 镜像</span>
</span></span><span class=line><span class=cl>docker run tomcat:8.0-jre8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 前台运行，会输出 tomcat 日志</span>
</span></span><span class=line><span class=cl><span class=c1># 按 Ctrl + C 停止</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 添加 -d 后台运行参数</span>
</span></span><span class=line><span class=cl>docker run -d tomcat:8.0-jre8
</span></span><span class=line><span class=cl><span class=c1># 查看容器列表，可以查看到容器的id、镜像(IMAGE)、状态(STATUS)、网络端口(PROT)、容器名称(NAME)等信息</span>
</span></span><span class=line><span class=cl>docker ps
</span></span><span class=line><span class=cl><span class=c1># 查看 tomcat 日志，这里的 `clever_swanson` 为容器id或名称</span>
</span></span><span class=line><span class=cl>docker logs clever_swanson
</span></span><span class=line><span class=cl><span class=c1># 查看容器内部进程信息</span>
</span></span><span class=line><span class=cl>docker top clever_swanson
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 进入容器</span>
</span></span><span class=line><span class=cl><span class=c1># i 和 t 参数可以让我们以伪终端的方式进入容器</span>
</span></span><span class=line><span class=cl><span class=c1># bash 是所使用 shell</span>
</span></span><span class=line><span class=cl>docker <span class=nb>exec</span> -it clever_swanson bash
</span></span><span class=line><span class=cl><span class=c1># 在容器内可以使用 Linux 命令</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 退出容器，回到宿主机（宿主机就是安装 Docker 的这台机器）</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 不需要容器了，可以停止容器</span>
</span></span><span class=line><span class=cl>docker stop clever_swanson
</span></span><span class=line><span class=cl><span class=c1># 查看容器列表，tomcat 就隐藏了</span>
</span></span><span class=line><span class=cl>docker ps
</span></span><span class=line><span class=cl><span class=c1># -a 参数查看全部所有容器的列表（包括停止的 tomcat）</span>
</span></span><span class=line><span class=cl>docker ps -a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 启动已经停止的容器</span>
</span></span><span class=line><span class=cl>docker start clever_swanson
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 删除容器，如果容器还在运行需要加 -f 参数</span>
</span></span><span class=line><span class=cl>docker rm clever_swanson
</span></span><span class=line><span class=cl>docker rm -f clever_swanson
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 删除了容器，就可以把镜像也删除了，如果有容器还是该镜像需要加 -f 参数</span>
</span></span><span class=line><span class=cl>docker rmi tomcat:8.0-jre8
</span></span><span class=line><span class=cl>docker rmi -f tomcat:8.0-jre8
</span></span></code></pre></div><h3 id=场景1tomcat>场景1：Tomcat<a hidden class=anchor aria-hidden=true href=#场景1tomcat>#</a></h3><p>只是将 Tomcat 容器 run 起来，还是无法满足使用
还需要将容器网络端口映射到宿主机才可以使得外部可以访问容器内部服务
为了方便还需要把 Tomcat 的数据目录和配置目录挂载到宿主机，方便直接进行编辑</p><p>可参考官方文档：<a href=https://hub.docker.com/_/tomcat>Tomcat</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 部署 Tomcat</span>
</span></span><span class=line><span class=cl><span class=c1># run 容器时，本地不存在对应镜像，会自动 pull</span>
</span></span><span class=line><span class=cl><span class=c1># -p 将容器内的网络端口映射到宿主机 ，8080:8080 前面为宿主机，后面为容器</span>
</span></span><span class=line><span class=cl><span class=c1># --name 指定容器名称</span>
</span></span><span class=line><span class=cl>docker run -p 8080:8080 -d --name mytomcat tomcat:8.0-jre8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 可以通过 docker 的子命令对 容器进行操作，比如：ps,exec,top,stop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 这个容器已经占用了宿主机的 8080 端口，为了后续的 Tomcat 可以绑定到宿主机的 8080 端口，所以将 这个容器 stop</span>
</span></span><span class=line><span class=cl>docker stop mytomcat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 通过数据卷的方式 将容器内的数据映射到宿主机</span>
</span></span><span class=line><span class=cl><span class=c1># 语法：- v 数据卷名称:容器内目录</span>
</span></span><span class=line><span class=cl><span class=c1># Tomcat 部署的 web应用目录：/usr/local/tomcat/webapps</span>
</span></span><span class=line><span class=cl><span class=c1># 配置文件：/usr/local/tomcat/conf</span>
</span></span><span class=line><span class=cl>docker run -p 8080:8080 -v apps:/usr/local/tomcat/webapps -v confs:/usr/local/tomcat/conf -d --name mytomcat2 tomcat:8.0-jre8
</span></span></code></pre></div><p>这个时候 Tomcat 已经启动了，可以通过 <code>http://ip宿主机:8080</code> 来访问 Tomcat 的默认主页，例如我的访问地址 <a href=%60http://192.168.43.166:8080%60>http://192.168.43.166:8080</a> ，看到汤姆猫的图标就成功了。如果访问失败，可能是对应的 8080 端口没有开放，CentOS7 可以参考：<a href=https://blog.csdn.net/zx110503/article/details/78787483>CentOS7开启端口</a></p><h3 id=场景2mysql>场景2：MySQL<a hidden class=anchor aria-hidden=true href=#场景2mysql>#</a></h3><p>可参考官方文档：<a href="https://hub.docker.com/_/mysql?tab=description&amp;page=1&amp;ordering=last_updated">MySQL</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 通过 -e 指定参数，指定 MySQL 的 root 账户的密码为：1234</span>
</span></span><span class=line><span class=cl>docker run --name mysql -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>1234</span> -p 3306:3306 -d mysql:5.7.32
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 停止容器，防止端口占用</span>
</span></span><span class=line><span class=cl>docker stop mysql
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 数据库的数据将会随着容器消失而消失，所以需要将数据库文件持久化到宿主机，</span>
</span></span><span class=line><span class=cl><span class=c1># 配置映射到本地</span>
</span></span><span class=line><span class=cl>docker run --name mysql2 -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>1234</span> -p 3306:3306 -d -v mysqldata:/var/lib/mysql -v mysqlconfig:/etc/mysql  mysql:5.7.32
</span></span></code></pre></div><p>MySQL 就成功运行了，可以通过 Navicat 或者其他工具测试数据库，地址为宿主机 ip地址，用户名为 root，密码为：1234，可以尝试存储数据，数据会被存储在数据卷，这里指定的数据卷名称为：mysqldata</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看所有数据卷</span>
</span></span><span class=line><span class=cl>docker volume ls
</span></span><span class=line><span class=cl><span class=c1># 查看 MySQL 的数据卷</span>
</span></span><span class=line><span class=cl>docker inspect mysqldata
</span></span><span class=line><span class=cl><span class=c1># 返回的 json 对象，其中 Mountpoint 的值就是，文件对应挂载的位置</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 我这里挂载的地址为：/var/lib/docker/volumes/mysqldata/_data</span>
</span></span><span class=line><span class=cl><span class=c1># 进入这个目录，就可以看到存储的文件</span>
</span></span></code></pre></div><p>使用数据卷的好处在于：容器被移除了，重新运行一个新容器，直接挂载原来的数据卷就可了，数据不会丢失</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 移除容器</span>
</span></span><span class=line><span class=cl>docker rm -f mysql2
</span></span><span class=line><span class=cl><span class=c1># 重新运行新的容器，并挂载原来的数据卷</span>
</span></span><span class=line><span class=cl>docker run --name mysql2 -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>1234</span> -p 3306:3306 -d -v mysqldata:/var/lib/mysql -v mysqlconfig:/etc/mysql  mysql:5.7.32
</span></span></code></pre></div><h3 id=redis>Redis<a hidden class=anchor aria-hidden=true href=#redis>#</a></h3><p>可参考官方文档：<a href="https://hub.docker.com/_/redis?tab=description&amp;page=1&amp;ordering=last_updated">Redis</a></p><p>需要注意的是：Redis 需要在镜像名称即 <code>redis:5.0.10</code> 的后面添加 <code>redis-server --appendonly yes</code> ，以此覆盖镜像默认的命令</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --name redis -p 6379:6379 -d redis:5.0.10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 停止容器，防止端口占用</span>
</span></span><span class=line><span class=cl>docker stop redis
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 开启持久化 redis-server --appendonly yes</span>
</span></span><span class=line><span class=cl><span class=c1># 开启后，持久化生成的 aop 文件会被放入容器中的 /data 目录中</span>
</span></span><span class=line><span class=cl>docker run --name redis2 -p 6379:6379 -d -v redisdata:/data redis:5.0.10 redis-server --appendonly yes
</span></span><span class=line><span class=cl><span class=c1># 可以使用 Redis Desktop Manager 等工具，通过宿主机 ip 连接，进行测试</span>
</span></span></code></pre></div><h3 id=清理容器>清理容器<a hidden class=anchor aria-hidden=true href=#清理容器>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看容器列表可以看到很多容器</span>
</span></span><span class=line><span class=cl>docker ps
</span></span><span class=line><span class=cl><span class=c1># -a 可以看到所有的容器，包括已经停止的</span>
</span></span><span class=line><span class=cl>docker ps -a
</span></span><span class=line><span class=cl><span class=c1># 如果忘记了参数或者命令可以在命令后面加上 --help，会有提示</span>
</span></span><span class=line><span class=cl>docker ps --help
</span></span><span class=line><span class=cl><span class=c1># 可以看到：-q, --quiet   Only display container IDs，即：-q参数仅输出容器id，结合 -a，可以输出所有容器的 id</span>
</span></span><span class=line><span class=cl>docker ps -aq
</span></span><span class=line><span class=cl><span class=c1># 结合 rm -f 就可以移除所有的容器了</span>
</span></span><span class=line><span class=cl>docker rm -f <span class=k>$(</span>docker ps -aq<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 清除没有用到的数据卷，有重要数据要谨慎</span>
</span></span><span class=line><span class=cl>docker volume prune
</span></span></code></pre></div><h2 id=docker>docker<a hidden class=anchor aria-hidden=true href=#docker>#</a></h2><p>我们可以通过下面的命令，来找到 docker 的位置</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>whereis docker
</span></span><span class=line><span class=cl><span class=c1># 我这里执行返回的结果是：docker: /usr/bin/docker /etc/docker /usr/libexec/docker /usr/share/man/man1/docker.1.gz</span>
</span></span></code></pre></div><p>可以看到 <code>docker</code> 的可执行文件位于 <code>/usr/bin</code>，这个路径存在环境变量 PATH 中，所以我们可以在任意路径 使用 <code>docker</code> 命令</p><p>Docker 是 C/S 架构模式（客户端-服务器），所以上面的 <code>docker</code> 实际上是 Docker 的客户端，Docker 的服务器是 Docker Deamon 对应的就是 <code>dockerd</code>，也在这个目录下，Deamon 就是 Docker 引擎，Docker 客户端通过 Docker API 与 Deamon 进行通信</p><p><code>docker</code> 是一个可执行程序，包含了许多命令，输入</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker --help
</span></span></code></pre></div><p>会将 Usage（用法）、Option（选项）、Commands（命令）都展示出来，Management Commands 也s是 Commands。每个命令可能会有它自己的子命令、选项</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># run 命令有许多的选项</span>
</span></span><span class=line><span class=cl>docker run --help
</span></span><span class=line><span class=cl><span class=c1># volume 命令有许多子命令，例如：ls, rm, inspect</span>
</span></span><span class=line><span class=cl>docker volume --help
</span></span></code></pre></div><h2 id=命令梳理>命令梳理<a hidden class=anchor aria-hidden=true href=#命令梳理>#</a></h2><p>使用 <code>--help</code> 参数，就可以查询到到对应命令的使用方法，所以我们只要理解 Docker 命令的框架即可，不用记忆命令细节
对镜像进行操作：images, rmi, search
对容器进行操作：run, stop, start, restart, exec, logs, top
其他：ps, cp, info, pull, version</p><p>还有一些 <code>Management Commands</code>，例如：image, network, volume
这些命令都是名词，即要操作的对象，而具体的操作通过其子命令指定，语义更加清晰
image 常用子命令：ls, rm, prune
network 常用子命令：create, ls, inspect, rm, prune
volume 常用子命令：同上面 network 的四个</p><h2 id=参考资料>参考资料<a hidden class=anchor aria-hidden=true href=#参考资料>#</a></h2><p><a href=https://docs.docker.com/engine/install/centos/#install-using-the-convenience-script>Install docker using the convenience script</a>
<a href=https://www.bilibili.com/video/BV1ZT4y1K75K>【编程不良人】Docker容器技术&amp;Docker-Compose实战</a>
<a href=https://www.jianshu.com/p/1ffe8c18dfd5>Docker组件</a>
<a href=https://www.jianshu.com/p/5dbc12e8b6f9>Docker 组件之间的关系</a></p><hr><p>下一节：<a href=https://www.cnblogs.com/aaronlinv/p/15213211.html>Dockerfile 实践及梳理</a></p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://aaronlinv.github.io/posts/springboot-%E6%95%B4%E5%90%88-springsecurity-%E6%A2%B3%E7%90%86/><span class=title>« Prev</span><br><span>SpringBoot 整合 SpringSecurity 梳理</span>
</a><a class=next href=https://aaronlinv.github.io/posts/oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E6%AF%94mysql/><span class=title>Next »</span><br><span>Oracle数据库对比MySQL</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://aaronlinv.github.io/>Aaron Lin</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>